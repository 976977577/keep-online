# Keep Online

一个用于保持企业微信在线状态的 Python 脚本，通过智能模拟鼠标移动来防止系统检测到用户离开状态。

## 功能特性

- 🖱️ **智能鼠标模拟**：在检测到鼠标长时间未移动时，自动进行轻微的鼠标移动
- ⏰ **时间段控制**：支持设置活跃时间段，只在指定时间内工作
- 🔧 **灵活配置**：支持命令行参数和交互式配置
- 🛡️ **安全可靠**：移动幅度极小，不会干扰正常工作
- 🚫 **智能暂停**：非活跃时间段自动暂停工作

## 安装依赖

```bash
pip install pyautogui schedule
```

## 使用方法

### 基本使用

```bash
python keep.py
```

运行后会提示选择活跃时间段：
- 选项 1：工作时间段（9:30-20:30）
- 选项 2：全天（00:00-23:59）

### 命令行参数

```bash
python keep.py [选项]
```

### 后台运行

#### 使用 nohup 启动（推荐）

```bash
# 后台运行，输出重定向到 nohup.out
nohup python keep.py &

# 后台运行，指定输出文件
nohup python keep.py > keep.log 2>&1 &

# 后台运行，带参数
nohup python keep.py -t 600 -a "9:00-18:00" > keep.log 2>&1 &
```

#### 查看运行状态

```bash
# 查看进程
ps aux | grep keep.py

# 查看输出日志
tail -f nohup.out
# 或
tail -f keep.log
```

#### 停止程序

```bash
# 方法1：通过进程名查找并终止
pkill -f keep.py

# 方法2：先查找进程ID，再终止
ps aux | grep keep.py
kill [进程ID]

# 方法3：强制终止（谨慎使用）
pkill -9 -f keep.py
```

#### 参数说明

- `-t, --idle`：设置检测鼠标不动的时间（秒），默认 600 秒（10 分钟）
- `-a, --active`：设置活跃时间段，格式为 'HH:MM-HH:MM'

#### 使用示例

```bash
# 设置 5 分钟检测间隔
python keep.py -t 300

# 设置自定义活跃时间段
python keep.py -a "8:00-18:00"

# 组合使用
python keep.py -t 300 -a "8:00-18:00"
```

## 工作原理

1. **定时检测**：每 30 秒检查一次当前是否在活跃时间段内
2. **鼠标监控**：记录鼠标位置，在设定时间后检查是否有移动
3. **智能模拟**：如果鼠标在指定时间内未移动，进行 1 像素的上下移动
4. **时间控制**：只在设定的活跃时间段内工作，其他时间自动暂停

## 配置说明

### 默认配置

- **检测间隔**：600 秒（10 分钟）
- **默认活跃时间**：9:30-20:30
- **检查频率**：每 30 秒检查一次
- **移动幅度**：1 像素上下移动

### 时间段格式

时间段使用 24 小时制格式：`HH:MM-HH:MM`

示例：
- `9:30-18:30`：上午 9:30 到下午 6:30
- `00:00-23:59`：全天 24 小时
- `22:00-06:00`：跨午夜时间段（晚上 10 点到早上 6 点）

## 注意事项

⚠️ **重要提醒**

1. **合规使用**：请确保在允许的范围内使用此工具，遵守公司相关规定
2. **系统兼容性**：主要在 macOS 和 Windows 系统上测试，Linux 系统可能需要额外配置
3. **权限要求**：某些系统可能需要授予 Python 辅助功能权限
4. **安全退出**：使用 `Ctrl+C` 安全退出程序

## 系统要求

- Python 3.6+
- macOS / Windows / Linux
- 支持图形界面的系统

## 依赖库

- `pyautogui`：用于鼠标操作模拟
- `schedule`：用于任务调度

## 故障排除

### 常见问题

**Q: 程序运行后没有效果？**
A: 检查是否在活跃时间段内，确认系统权限设置正确。

**Q: macOS 提示权限问题？**
A: 前往 系统偏好设置 > 安全性与隐私 > 辅助功能，添加终端或 Python 的权限。

**Q: 如何确认程序正在工作？**
A: 程序启动时会显示配置信息，可以通过观察控制台输出确认运行状态。

## 许可证

本项目仅供学习和个人使用，请遵守相关法律法规和公司制度。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

---

**免责声明**：使用本工具的风险由用户自行承担，开发者不对任何后果负责。请确保在合规的前提下使用。